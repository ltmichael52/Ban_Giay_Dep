CREATE DATABASE ShoesStore;

USE [ShoesStore];

CREATE TABLE TAIKHOAN(
	EMAIL NVARCHAR(255) PRIMARY KEY NOT NULL,
	MATKHAU NVARCHAR(255) NOT NULL,
	LOAITK INT NOT NULL
);

Create table KHACHHANG(
	IDKH INT Primary Key Identity(1,1) NOT NULL,
	TENKH NVARCHAR(255) NOT NULL,
	EMAIL NVARCHAR(255) NOT NULL,
	DIACHI NVARCHAR(255) NOT NULL,
	SDT NVARCHAR(255) NOT NULL,
	GIOITINH bit NULL,
	NGAYSINH DATETIME,
	FOREIGN KEY(EMAIL) REFERENCES TAIKHOAN(EMAIL)
);

Create table NHANVIEN(
	IDNV INT Primary Key Identity(1,1) NOT NULL,
	TENNV NVARCHAR(255) NOT NULL,
	EMAIL NVARCHAR(255) NOT NULL,
	DIACHI NVARCHAR(255) NOT NULL,
	SDT NVARCHAR(255) NOT NULL,
	GIOITINH bit NOT NULL,
	NGAYSINH DATETIME,
	FOREIGN KEY(EMAIL) REFERENCES TAIKHOAN(EMAIL)
);

CREATE TABLE LOAI(
	IDLOAI INT PRIMARY KEY IDENTITY(1,1) NOT NULL,
	TENLOAI NVARCHAR(255) UNIQUE NOT NULL,
);

CREATE TABLE SANPHAM(
	IDSP INT PRIMARY KEY,
	IDLOAI INT NOT NULL,
	TENSP NVARCHAR(255) NOT NULL,
	HINHANH NVARCHAR(MAX) NOT NULL,
	SOLUONG INT NOT NULL,
	GIAGOC decimal(18, 2) NOT NULL,
	GIASALE decimal(18, 2),
	MAU NVARCHAR(255) NOT NULL,
	SIZE NVARCHAR(255) NOT NULL,
	DETAIL NVARCHAR(MAX) NOT NULL,
	HIENTHI bit ,
	HETHANG bit,
	GIAMGIA bit,
	MOI bit,
	HOT bit,
	FOREIGN KEY(IDLOAI) REFERENCES LOAI(IDLOAI)
);

CREATE TABLE PHIEUDAT(
	IDPD INT PRIMARY KEY IDENTITY(1,1) NOT NULL,
	NGAYDAT DATETIME NOT NULL,
	IDKH INT NOT NULL,
	IDNV INT,
	TINHTRANG NVARCHAR(255) NOT NULL,
	PHUONGTHUCTHANHTOAN NVARCHAR(255) NOT NULL,
	GHICHU NVARCHAR(MAX),
	LYDOHUYDON NVARCHAR(255),
	FOREIGN KEY(IDKH) REFERENCES KHACHHANG(IDKH),
	FOREIGN KEY(IDNV) REFERENCES NHANVIEN(IDNV)
);


CREATE TABLE CHITIETPHIEUDAT(
	IDPD INT NOT NULL,
	IDSP INT NOT NULL,
	TONGTIEN decimal(18, 2) NOT NULL,
	SOLUONG INT,
	FOREIGN KEY(IDPD) REFERENCES PHIEUDAT(IDPD),
	FOREIGN KEY(IDSP) REFERENCES SANPHAM(IDSP),
	PRIMARY KEY(IDPD,IDSP)
);

CREATE TABLE __EFMIGRATIONSHISTORY(
	MIGRATIONID NVARCHAR(255) NOT NULL,
	PRODUCTVERSION NVARCHAR(255) NOT NULL
);

INSERT INTO __EFMIGRATIONSHISTORY(MIGRATIONID,PRODUCTVERSION) VALUES ('20240217002815_v0','7.0.16');
